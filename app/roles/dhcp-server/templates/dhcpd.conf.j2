#
# Faros DHCP Configuration File
#
# !! DO NOT EDIT THIS FILE !!
# To customize the DHCP server, make changes to /etc/dhcp/dhcpd.custom.conf
# Changes made to this file may be overwritten by the farosctl command.
#

default-lease-time  600;
max-lease-time      7200;
authoritative;
ddns-update-style   none;

option space pxelinux;
option pxelinux.magic code 208 = string;
option pxelinux.configfile code 209 = text;
option pxelinux.pathprefix code 210 = text;
option pxelinux.reboottime code 211 = unsigned integer 32;
option architecture-type code 93 = unsigned integer 16;

include             "/etc/dhcp/dhcpd.custom.conf";

subnet {{ dhcp_server_subnet | ipaddr('network') }} netmask {{ dhcp_server_subnet | ipaddr('netmask') }} {
    option routers              {{ dhcp_server_bastion_lan_ip }};
    option subnet-mask          {{ dhcp_server_subnet | ipaddr('netmask') }};
    option domain-name          "{{ dhcp_server_domain }}";
    option domain-name-servers  {{ dhcp_server_bastion_lan_ip }};
    option ntp-servers          {{ dhcp_server_bastion_lan_ip }};

    pool {
        range {{ dhcp_server_dyn_range | ipaddr('next_usable') }} {{ dhcp_server_dyn_range | ipaddr('last_usable') }};
    }

    class "pxeclients" {
        match if substring (option vendor-class-identifier, 0, 9) = "PXEClient";
        next-server         {{ dhcp_server_bastion_lan_ip }};

        if option architecture-type = 00:07 {
            filename "/uefi/bootx64.efi";
        } else {
            filename "/pxelinux.0";
        }
    }
}

include             "/etc/dhcp/dhcpd.static.conf";
